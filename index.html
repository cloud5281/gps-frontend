<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>即時移動測繪系統</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="info-panel">
        <div class="panel-header-row">
            <span class="panel-title">狀態監控</span>
            <button id="btn-open-settings" class="btn-icon">⚙️ 系統參數</button>
        </div>
        
        <div class="status-box">
            <span id="status-dot" class="status-dot st-offline"></span>
            <span id="connection-text" class="status-text">未連線</span>
        </div>

        <div class="data-grid-container">
            <div class="data-label">時間:</div>
            <div class="data-value" id="time">-</div>

            <div class="data-label">專案:</div>
            <div class="data-value highlight-blue" id="currentPath">-</div>

            <div class="data-label">座標:</div>
            <div class="data-value" id="coords">-</div>

            <div class="data-label">濃度:</div>
            <div class="data-value" id="concentration">-</div>
        </div>
        
        <div class="checkbox-row">
            <label class="checkbox-label">
                <input type="checkbox" id="autoCenter" checked> 自動跟隨
            </label>
        </div>

        <div class="threshold-section">
            <div class="section-header">
                <span>濃度閾值設定</span>
                <small>(Enter 儲存)</small>
            </div>
            
            <div class="th-grid-row">
                <span class="th-badge bg-green">綠</span>
                <span></span> <span class="th-symbol">&lt;</span>
                <input type="number" id="val-a" value="50" class="th-input">
            </div>

            <div class="th-grid-row">
                <span class="th-badge bg-yellow">黃</span>
                <span id="disp-a" class="th-start-val">50</span>
                <span class="th-symbol">~</span>
                <input type="number" id="val-b" value="100" class="th-input">
            </div>

            <div class="th-grid-row">
                <span class="th-badge bg-orange">橙</span>
                <span id="disp-b" class="th-start-val">100</span>
                <span class="th-symbol">~</span>
                <input type="number" id="val-c" value="150" class="th-input">
            </div>

            <div class="th-grid-row">
                <span class="th-badge bg-red">紅</span>
                <span></span> <span class="th-symbol">&ge;</span>
                <span id="disp-c" class="th-static-end">150</span>
            </div>

            <div class="msg-container">
                <span id="msg-box"></span>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>系統參數設定</h3>
                <span id="btn-close-modal" class="close-btn">&times;</span>
            </div>
            
            <div class="modal-body">
                <div class="modal-form-grid">
                    <label>專案名稱 (ID)</label>
                    <input type="text" id="set-project-id" class="form-input" placeholder="例如: real-time-gps">
                    
                    <label>GPS 連線 IP</label>
                    <input type="text" id="set-gps-ip" class="form-input" placeholder="192.168.x.x">

                    <label>GPS 連線 Port</label>
                    <input type="number" id="set-gps-port" class="form-input" placeholder="8080">

                    <label>濃度單位</label>
                    <input type="text" id="set-conc-unit" class="form-input" placeholder="ppm, ppb...">
                </div>
            </div>
            
            <div class="modal-footer">
                <button id="btn-save-backend" class="btn-primary">儲存並應用</button>
            </div>
        </div>
    </div>

    <div class="bottom-control-bar">
        <button id="btn-upload" class="ctrl-btn btn-secondary">上傳</button>
        <button id="btn-start" class="ctrl-btn btn-primary-large">開始</button>
        <button id="btn-download" class="ctrl-btn btn-secondary">下載</button>
    </div>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script type="module" src="app.js"></script>
</body>
</html>